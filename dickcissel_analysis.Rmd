---
title: >
  </div>
  <div style="text-align: center;">
    <br>
    Mod√©lisation des facteurs influen√ßant l'abondance des dickcissels<br><br>
    <img src="https://media.licdn.com/dms/image/v2/C4E0BAQGYBmRCN7M_JA/company-logo_200_200/company-logo_200_200/0/1630581857994?e=2147483647&amp;v=beta&amp;t=e4N2KtKFW8ieFFhgkPwXPqZYxpGDW_pZLRnXXs_ofko" alt="Logo" style="height: 60px; margin-bottom: 10px;" />
author: "EL Moustapha JIDDOU"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    keep_md: no
    toc: yes
    toc_depth: 2
    number_sections: yes
    theme: cerulean
  pdf_document:
    toc: yes
    toc_depth: '2'
---
<style>
  h1.title {
    text-align: center;
  }
  h4.author {
    text-align: center;
  }
  h4.date {
    text-align: center;
  }
</style>



# .R√©sum√©

Ce rapport examine les facteurs influen√ßant l'abondance des dickcissels √† l'aide d'une r√©gression lin√©aire multiple. √Ä partir d'un ensemble de donn√©es environnementales, nous identifions les variables explicatives pertinentes. Une analyse descriptive et une mod√©lisation statistique sont pr√©sent√©es pour interpr√©ter les r√©sultats.


# .Introduction


### .Probl√©matique
L'abondance des dickcissels est influenc√©e par plusieurs facteurs environnementaux, tels que les conditions climatiques et les caract√©ristiques de leur habitat. Comprendre ces relations est crucial pour pr√©server cette esp√®ce et anticiper les impacts des changements environnementaux.

### .Objectifs
- Identifier les variables environnementales ayant un impact significatif sur l'abondance des dickcissels.
- Mod√©liser la relation entre ces variables et l'abondance en utilisant une r√©gression lin√©aire multiple.
- Fournir des recommandations bas√©es sur les r√©sultats pour mieux g√©rer les habitats naturels de ces oiseaux.

# .Description des donn√©es

Le jeu de donn√©es dickcissel utilis√© contient 646 observations et 15 variables principales. Voici une description des variables incluses dans l'√©tude.

| **Nom de la variable** | **Description**                                                       | **Type**      |
|-------------------------|-----------------------------------------------------------------------|---------------|
| `abund`                | Abondance des dickcissels (nombre d'individus observ√©s).             | Num√©rique     |
| `Present`              | Pr√©sence ou absence des dickcissels dans la zone observ√©e.           | Cat√©gorique   |
| `clDD`                 | Degr√©-jour cumulatif pour le climat.                                 | Num√©rique     |
| `clFD`                 | Nombre de jours de gel.                                              | Num√©rique     |
| `clTmi`                | Temp√©rature minimale moyenne (¬∞C).                                   | Num√©rique     |
| `clTma`                | Temp√©rature moyenne maximale (¬∞C).                                   | Num√©rique     |
| `clTmn`                | Temp√©rature moyenne minimale (¬∞C).                                   | Num√©rique     |
| `clP`                  | Pr√©cipitations moyennes cumul√©es (mm).                               | Num√©rique     |
| `NDVI`                 | Indice de v√©g√©tation normalis√© (NDVI).                               | Num√©rique     |
| `broadleaf`            | Proportion de la couverture par les for√™ts feuillues.                | Num√©rique     |
| `conif`                | Proportion de la couverture par les conif√®res.                       | Num√©rique     |
| `grass`                | Proportion de la couverture par les herbes.                          | Num√©rique     |
| `crop`                 | Proportion de la couverture par les cultures.                        | Num√©rique     |
| `urban`                | Proportion de la couverture par les zones urbaines.                  | Num√©rique     |
| `wetland`              | Proportion de la couverture par les zones humides.                   | Num√©rique     |

Cette table d√©crit toutes les variables disponibles dans le jeu de donn√©es avec leurs types et significations. Elle constitue la base pour l'analyse univari√©e et les mod√®les statistiques dans les sections suivantes.


# .Analyse univari√©e
### .Les donn√©es utilis√©es comprennent 646 observations avec 15 variables principales : 7 variables climatiques, 7 paysag√®res et 1 variable d√©pendante, l‚Äôabondance (abund). Une analyse univari√©e a permis de d√©crire les caract√©ristiques de chaque variable, en visualisant leur distribution et leurs tendances. Les r√©sultats montrent des variabilit√©s importantes, notamment dans les pr√©cipitations (clP) et l‚Äôindice de v√©g√©tation (NDVI).


## .Library n√©cessaire
```{r}
library(ggplot2)
library(dplyr)
library(naniar)
library(e1071)
library(GGally)
library(corrplot)
library(ggcorrplot)
library(car)
library(vegan)
library(MASS)
library(RColorBrewer)
library(broom)
library(gridExtra)
# V√©rification automatique des paquets manquants
required_packages <- c("ggplot2", "dplyr", "naniar", "e1071", "GGally", "corrplot", "ggcorrplot", "car", "vegan", "MASS", "RColorBrewer", "broom", "gridExtra")
installed_packages <- rownames(installed.packages())
missing_packages <- setdiff(required_packages, installed_packages)
if (length(missing_packages) > 0) {
  install.packages(missing_packages)
}
```
## .Chargement et Pr√©paration des Donn√©es
```{r}
# V√©rifier que le fichier existe avant de charger
if (file.exists("dickcissel.csv")) {
  Dickcissel <- read.csv("dickcissel.csv")
  # V√©rifier la structure et le r√©sum√© des donn√©es
  str(Dickcissel)
  summary(Dickcissel)
} else {
  stop("Le fichier 'dickcissel.csv' est introuvable dans le r√©pertoire de travail.")
}
```
### .Distributions des variable quantitative
```{r}

# Identifier les variables num√©riques
num_vars <- c("abund", "clDD", "clFD", "clTmi", "clTma", "clTmn", "clP", "NDVI", "broadleaf", "conif", "grass", "crop", "urban", "wetland")
palette_colors <- brewer.pal(n = min(length(num_vars), 12), name = "Paired")

# Boucle pour cr√©er des histogrammes
for (i in seq_along(num_vars)) {
  col <- num_vars[i]
  print(
    ggplot(Dickcissel, aes_string(x = col)) +
      geom_histogram(
        aes(y = ..density..),
        bins = 30,
        fill = palette_colors[i %% length(palette_colors) + 1],
        color = "black",
        alpha = 0.7
      ) +
      geom_vline(
        aes_string(xintercept = paste("mean(", col, ", na.rm = TRUE)")),
        color = "brown",
        linetype = "dashed",
        linewidth = 1
      ) +
      geom_density(
        color = palette_colors[i %% length(palette_colors) + 1],
        linewidth = 1,
        adjust = 1
      ) +
      labs(
        title = paste("Histogramme de", col),
        x = col,
        y = "Densit√©"
      ) +
      theme_minimal(base_size = 15) +
      theme(
        plot.title = element_text(hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 14),
        axis.text = element_text(size = 12)
      )
  )
}

```
Les histogrammes des variables √©tudi√©es r√©v√®lent des distributions vari√©es. Certaines variables, comme `clDD`, `clTmi`, et `clTma`, pr√©sentent des distributions sym√©triques ou proches de la normale, ce qui les rend directement adapt√©es aux analyses lin√©aires. D'autres, comme `abund`, `broadleaf`, `grass`, et `urban`, montrent des asym√©tries marqu√©es avec des valeurs fortement concentr√©es pr√®s de z√©ro, sugg√©rant la n√©cessit√© de transformations (par exemple, logarithmiques) pour am√©liorer leur normalit√©. Les variables cat√©goriques et certaines variables num√©riques, telles que `crop`, affichent des r√©partitions sp√©cifiques avec des pics distincts qui refl√®tent des caract√©ristiques r√©gionales ou structurelles. En r√©sum√©, les donn√©es pr√©sentent une diversit√© de distributions, et un pr√©traitement est essentiel pour certaines variables avant leur int√©gration dans des mod√®les statistiques.

## .Statistiques descriptives g√©n√©rales (pour les variables num√©riques)
```{r}
# S√©lection des variables num√©riques
num_vars <- c("abund", "clDD", "clFD", "clTmi", "clTma", "clTmn", "clP", 
              "NDVI", "broadleaf", "conif", "grass", "crop", "urban", "wetland")

# Calcul des statistiques descriptives
stat_desc <- Dickcissel[, num_vars] %>%
  summarise(across(
    everything(),
    list(
      Moyenne = ~mean(., na.rm = TRUE),
      M√©diane = ~median(., na.rm = TRUE),
      Minimum = ~min(., na.rm = TRUE),
      Maximum = ~max(., na.rm = TRUE),
      Ecart_Type = ~sd(., na.rm = TRUE)
    )
  ))

# Afficher les r√©sultats
print(stat_desc)
```
Les statistiques descriptives globales montrent une grande diversit√© dans les distributions des variables. La variable `abund` (abondance) a une moyenne de 10,11 avec une m√©diane de 0,2, indiquant une distribution asym√©trique fortement concentr√©e sur des valeurs faibles. Les variables climatiques comme `clDD` (degr√©-jour cumulatif) et `clFD` (jours de gel) ont des moyennes de 4410,67 et 115,08 respectivement, avec des √©carts-types √©lev√©s, refl√©tant une grande variabilit√©. La temp√©rature minimale (`clTmi`), maximale (`clTma`), et moyenne minimale (`clTmn`) pr√©sentent des valeurs moyennes mod√©r√©es autour de 4,03 ¬∞C, 30,69 ¬∞C, et 12,06 ¬∞C, sugg√©rant des conditions climatiques √©quilibr√©es dans les r√©gions √©tudi√©es.

L'indice de v√©g√©tation (`NDVI`) a une moyenne de -54,05, indiquant des zones √† faible couverture v√©g√©tale. Les proportions de couverture par les for√™ts feuillues (`broadleaf`), conif√®res (`conif`), herbes (`grass`), et cultures (`crop`) montrent des moyennes relativement faibles, avec des valeurs concentr√©es autour de z√©ro, ce qui est √©galement visible dans les variables `urban` (zones urbaines) et `wetland` (zones humides). 

Les √©carts-types des variables num√©riques, notamment `abund` (23,97) et `clDD` (1594,23), mettent en √©vidence une dispersion importante des donn√©es, ce qui est √©galement confirm√© par les valeurs minimums et maximums tr√®s √©loign√©es. Par exemple, `abund` varie de 0 √† 204, tandis que `clDD` va de 810,7 √† 8362,2. Ces r√©sultats indiquent que certaines variables pourraient n√©cessiter une transformation ou une normalisation avant leur int√©gration dans des mod√®les pr√©dictifs ou d'analyse.

En r√©sum√©, les donn√©es pr√©sentent une diversit√© de distributions et des asym√©tries marqu√©es pour plusieurs variables, ce qui justifie des √©tapes suppl√©mentaires de pr√©traitement pour garantir la validit√© des analyses statistiques.

## .Distribution des variables cat√©goriques
```{r}

# Couleur de la palette "Paired"
palette_color <- brewer.pal(n = 3, name = "Paired")[2]  # Utilisation d'une couleur de la palette

# Graphique en barres
ggplot(Dickcissel, aes(x = Present)) +
  geom_bar(
    fill = palette_color,  # Couleur de la palette
    color = "black",
    alpha = 0.7
  ) +
  labs(
    title = "R√©partition de la variable 'Present'",
    x = "Pr√©sence",
    y = "Fr√©quence"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12)
  )


```
La variable **Present** repr√©sente la pr√©sence ou l'absence des dickcissels dans les zones √©tudi√©es. Le graphique montre une r√©partition relativement √©quilibr√©e entre les deux cat√©gories : "Pr√©sent" et "Absent". Cela indique que les observations ne sont pas biais√©es en faveur d'une seule cat√©gorie, offrant une base solide pour l'analyse comparative des facteurs influen√ßant la pr√©sence des dickcissels. Cette r√©partition permet d‚Äôexplorer de mani√®re √©quitable les relations entre les variables explicatives et la pr√©sence ou l‚Äôabsence de cette esp√®ce.

## .Boxplots pour visualiser les distributions
```{r}
# Couleurs de la palette "Paired"
palette_colors <- brewer.pal(n = 12, name = "Paired")

# Boucle pour cr√©er des boxplots
for (i in seq_along(num_vars)) {
  col <- num_vars[i]
  print(
    ggplot(Dickcissel, aes_string(y = col)) +
      geom_boxplot(
        fill = palette_colors[i %% length(palette_colors) + 1],  # Couleur dynamique issue de "Paired"
        color = "black",
        alpha = 0.7
      ) +
      labs(
        title = paste("Boxplot de", col),
        y = col
      ) +
      theme_minimal(base_size = 15) +
      theme(
        plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
        axis.text.x = element_blank(),
        axis.title.x = element_blank(),
        axis.text.y = element_text(size = 12),
        axis.title.y = element_text(size = 14)
      )
  )
}

```
Les analyses r√©v√®lent des distributions vari√©es. Les variables climatiques, telles que **clDD** (degr√©-jour de croissance), **clFD** (jours de gel), et les temp√©ratures (**clTmi**, **clTma**, **clTmn**), pr√©sentent des distributions sym√©triques et stables, ce qui les rend directement exploitables pour des mod√©lisations.

En revanche, certaines variables, comme **abund** (abondance), montrent une asym√©trie marqu√©e avec une concentration des valeurs proches de z√©ro et des valeurs aberrantes √©lev√©es (au-del√† de 100). D'autres variables, telles que les pr√©cipitations (**clP**) et l'indice de v√©g√©tation (**NDVI**), pr√©sentent une asym√©trie plus mod√©r√©e avec des extr√™mes qui n√©cessitent une attention particuli√®re.

Les variables li√©es √† la couverture v√©g√©tale (**broadleaf**, **conif**, **grass**) et √† l'utilisation des terres (**crop**, **urban**, **wetland**) sont domin√©es par des valeurs nulles ou proches de z√©ro, ce qui indique une h√©t√©rog√©n√©it√© spatiale importante, particuli√®rement marqu√©e pour **wetland**.

## .Analyse des valeurs manquantes
```{r}

# Comptage des valeurs manquantes
missing_values <- sapply(Dickcissel, function(x) sum(is.na(x)))

# Afficher les variables avec des valeurs manquantes
print(missing_values)
gg_miss_var(Dickcissel, show_pct = TRUE) +
  labs(title = "Pourcentage de valeurs manquantes par variable") +
  theme_minimal()
```

# .Analyse bivari√©e
### .Une analyse bivari√©e a √©t√© men√©e pour explorer les relations entre l‚Äôabondance et les variables explicatives. La matrice de corr√©lation a r√©v√©l√© des associations significatives entre abund et plusieurs variables, notamment clTma, clFD et grass. Ces relations ont guid√© la s√©lection initiale des variables pour le mod√®le de r√©gression multiple.

## .Asym√©trie et Curtosis
```{r}

# Calculer asym√©trie et curtosis pour les variables num√©riques
asym_curt <- sapply(Dickcissel[, num_vars], function(x) {
  c(
    Asym√©trie = skewness(x, na.rm = TRUE),
    Curtosis = kurtosis(x, na.rm = TRUE)
  )
})

# Afficher les r√©sultats
print(asym_curt)

```

L'analyse des coefficients d'asym√©trie et de curtosis r√©v√®le des diff√©rences importantes dans la distribution des variables √©tudi√©es. Plusieurs variables pr√©sentent une forte asym√©trie positive, comme `abund` (3,91), `grass` (3,37), `urban` (6,85), et `wetland` (16,39), indiquant que leurs distributions sont fortement d√©cal√©es vers des valeurs faibles. Ces variables n√©cessitent potentiellement une transformation logarithmique ou une normalisation pour r√©duire l'asym√©trie.

En ce qui concerne la curtosis, certaines variables, comme `abund` (19,31), `NDVI` (16,15), et `wetland` (283,31), montrent des distributions tr√®s pointues avec de longues queues, ce qui sugg√®re la pr√©sence de valeurs extr√™mes. D'autres variables, comme `clDD` (-0,59) et `crop` (-1,53), ont des valeurs de curtosis proches de z√©ro ou n√©gatives, indiquant des distributions plus aplaties.
Dans l'ensemble, ces r√©sultats soulignent la n√©cessit√© de traiter certaines variables avant leur utilisation dans des mod√®les statistiques. Les transformations adapt√©es aux variables fortement asym√©triques ou avec une curtosis extr√™me permettront de garantir une meilleure normalit√© et stabilit√© dans les analyses.

## .Graphiques de dispersion avec lignes de tendance  
```{r}

# Identification des variables num√©riques
num_vars <- names(Dickcissel)[sapply(Dickcissel, is.numeric)]

# Couleurs de la palette "Paired"
palette_colors <- brewer.pal(n = 12, name = "Paired")

# Boucle pour cr√©er des graphiques de dispersion
for (i in seq_along(num_vars[-1])) {
  var <- num_vars[-1][i]
  print(
    ggplot(Dickcissel, aes_string(x = var, y = "abund")) +
      geom_point(color = palette_colors[i %% length(palette_colors) + 1], alpha = 0.6) +
      geom_smooth(method = "lm", color = "black", linetype = "dashed", se = FALSE) +
      labs(
        title = paste("Relation entre abund et", var),
        x = var,
        y = "abund"
      ) +
      theme_minimal(base_size = 15) +
      theme(
        plot.title = element_text(hjust = 0.5, face = "bold"),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 14)
      )
  )
}


```
Les graphiques montrent la relation entre la variable d√©pendante `abund` et les diff√©rentes variables explicatives. Les variables climatiques telles que `clDD`, `clFD`, `clTmi`, et `clTma` pr√©sentent une l√©g√®re tendance positive dans leur relation avec `abund`, sugg√©rant que des conditions climatiques plus favorables pourraient contribuer √† une augmentation de l'abondance. Cependant, les relations restent globalement faibles, comme en t√©moigne la dispersion importante des points autour de la droite de r√©gression. 
Les variables li√©es √† la v√©g√©tation, telles que `broadleaf` et `conif`, montrent des relations peu marqu√©es, avec une forte concentration des observations √† proximit√© de faibles valeurs pour ces variables. De mani√®re similaire, les variables li√©es √† l'utilisation des terres, comme `crop`, `urban` et `wetland`, ne semblent pas avoir de corr√©lation significative avec `abund`. Ces variables montrent une tr√®s faible variation de `abund` avec des valeurs proches de z√©ro pour la majorit√© des points.
la variable `NDVI`, un indicateur de la v√©g√©tation, pr√©sente une l√©g√®re relation n√©gative avec `abund`, ce qui pourrait refl√©ter des conditions sp√©cifiques o√π une densit√© v√©g√©tale √©lev√©e n'est pas directement associ√©e √† une augmentation de l'abondance. Globalement, les relations identifi√©es sont faibles et justifient l'inclusion de ces variables dans un mod√®le pour mieux comprendre leurs contributions individuelles et combin√©es √† la pr√©diction de l'abondance.

## .Analyse des relations cat√©goriques  
```{r}
# Identification des variables cat√©goriques
cat_vars <- names(Dickcissel)[sapply(Dickcissel, is.character)]

# Couleurs de la palette "Paired"
palette_colors <- brewer.pal(n = 12, name = "Paired")

# Boucle pour cr√©er des boxplots
for (i in seq_along(cat_vars)) {
  var <- cat_vars[i]
  print(
    ggplot(Dickcissel, aes_string(x = var, y = "abund")) +
      geom_boxplot(fill = palette_colors[i %% length(palette_colors) + 1], color = "black", alpha = 0.7) +
      labs(
        title = paste("Relation entre abund et", var),
        x = var,
        y = "abund"
      ) +
      theme_minimal(base_size = 15) +
      theme(
        plot.title = element_text(hjust = 0.5, face = "bold"),
        axis.text.x = element_text(angle = 45, hjust = 1)
      )
  )
}


```
Le boxplot pr√©sente la relation entre la variable d√©pendante `abund` et la variable cat√©gorielle `Present`, qui indique la pr√©sence ou l'absence. Les observations montrent que la distribution de `abund` est nettement plus concentr√©e et vari√©e dans la cat√©gorie "Absent", tandis qu'elle reste proche de z√©ro pour la cat√©gorie "Present". Cela sugg√®re que l'abondance est principalement associ√©e √† des conditions o√π la pr√©sence est absente, ce qui pourrait indiquer une influence significative de cette variable sur `abund`. Cette tendance doit √™tre confirm√©e dans la mod√©lisation ult√©rieure pour √©valuer la contribution r√©elle de `Present` √† la pr√©diction de l'abondance.


# .Analyse multivari√©e
### .Les variables explicatives ont √©t√© s√©lectionn√©es √† l'aide d'une approche pas √† pas (stepwise), ce qui a permis de retenir les interactions les plus pertinentes et de maximiser le R¬≤ ajust√©. Le mod√®le final a √©t√© valid√© par la v√©rification des hypoth√®ses (normalit√© des r√©sidus, homog√©n√©it√© des variances, ind√©pendance) et une analyse de la multicolin√©arit√© via le VIF, confirmant sa conformit√© aux conditions n√©cessaires. Les r√©sultats indiquent que clTma, clFD et grass sont des pr√©dicteurs significatifs de l‚Äôabondance, expliquant environ 56 % de la variance totale (R¬≤ ajust√© = 0.56). Cela met en √©vidence l'importance des facteurs climatiques et paysagers dans la mod√©lisation de l'abondance des dickcissels.

## .S√©lection des variables  
```{r}

# S√©lection des variables num√©riques
num_vars <- names(Dickcissel)[sapply(Dickcissel, is.numeric)]

# Filtrer uniquement les variables num√©riques
data_numeric <- Dickcissel[, num_vars]

# Calculer la matrice de corr√©lation
cor_matrix <- cor(data_numeric, use = "complete.obs")

# Visualisation avec ggcorrplot et palette "Paired"
ggcorrplot(
  cor_matrix, 
  method = "circle", 
  lab = TRUE, 
  lab_size = 3, 
  colors = brewer.pal(n = 3, name = "Paired"),  # Palette Paired
  title = "Matrice de corr√©lation",
  ggtheme = theme_minimal(base_size = 15) +
    theme(
      plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
      axis.text.x = element_text(size = 12, angle = 45, hjust = 1),
      axis.text.y = element_text(size = 12)
    )
)


```
La matrice de corr√©lation r√©v√®le les relations lin√©aires entre la variable d√©pendante `abund` et les variables explicatives. Les variables telles que `clDD`, `clFD`, et `clTmi` pr√©sentent des corr√©lations positives mod√©r√©es √† fortes avec `abund`, sugg√©rant leur pertinence pour la mod√©lisation. En revanche, des variables comme `NDVI` montrent des corr√©lations n√©gatives, tandis que d'autres, telles que `wetland`, `urban` et `grass`, affichent des corr√©lations faibles, indiquant une influence potentiellement n√©gligeable. De plus, la forte colin√©arit√© entre certaines variables explicatives, comme `clTma`, `clTmn`, et `clFD`, pourrait poser des d√©fis lors de la mod√©lisation, n√©cessitant des ajustements tels que la s√©lection ou la r√©gularisation des variables. Ces observations guideront la construction du mod√®le multiple en identifiant les variables cl√©s tout en anticipant les probl√©matiques de colin√©arit√©.

## .Construction du mod√®le de r√©gression lin√©aire multiple
```{r}
lm.model <- lm(abund ~ clDD + clFD + clTmi + clTma + clTmn + clP + NDVI +
                broadleaf + conif + grass + crop + urban + wetland, data = Dickcissel)

# R√©sum√© du mod√®le
summary(lm.model)
```
Le mod√®le initial inclut toutes les variables disponibles. Les r√©sultats montrent que certaines variables, telles que `clFD`, `clTmi`, `clTma`, et `grass`, sont significatives, tandis que d'autres, comme `clDD` et `clTmn`, ne le sont pas. Le coefficient de d√©termination ajust√© (R¬≤ ajust√©) est de 0.3109, indiquant que le mod√®le explique environ 31 % de la variance observ√©e. Cependant, la pr√©sence de nombreuses variables non significatives rend ce mod√®le moins performant, avec une complexit√© inutile.



### .Construction du mod√®le avec interactions et S√©lection de variables
```{r}
full.model <- lm(abund ~ (clDD + clFD + clTmi + clTma + clTmn + clP + NDVI +
                          broadleaf + conif + grass + crop + urban + wetland)^2, 
                 data = Dickcissel)
# Mod√®le stepwise
stepwise.model <- step(full.model, direction = "both")

# R√©sum√© du mod√®le stepwise
summary(stepwise.model)

```
Le mod√®le Stepwise s√©lectionne automatiquement les variables et leurs interactions les plus pertinentes en fonction de l'AIC. Ce mod√®le am√©liore consid√©rablement les performances en atteignant un R¬≤ ajust√© de 0.5154. Les interactions comme `clDD:clTma`, `clFD:clTma`, et `grass:crop` jouent un r√¥le cl√© dans l'explication de la variance. Bien que plus complexe, ce mod√®le capture mieux les relations sous-jacentes entre les variables tout en √©liminant les pr√©dicteurs non significatifs.


## .Validation du mod√®le






### .Estimation ponctuelle sans biais de la variance des erreursùúé¬≤
```{r}
# Estimation ponctuelle de la variance des erreurs
sigma_squared <- summary(stepwise.model)$sigma^2
cat("L'estimation de la variance des erreurs œÉ¬≤ est :", sigma_squared, "\n")
```
L'estimation de la variance des erreurs (\( \sigma^2 \)) est de **278.5403**, indiquant la variabilit√© moyenne des r√©sidus autour de la ligne de r√©gression. Cette mesure refl√®te dans quelle mesure les pr√©dictions du mod√®le s'√©cartent des valeurs observ√©es, et une variance relativement faible sugg√®re un bon ajustement du mod√®le.

### .Erreur standard deùõΩ
```{r}
# Erreurs standard des coefficients
standard_errors <- summary(stepwise.model)$coefficients[, "Std. Error"]
cat("L'erreur standard de Œ≤ÃÇ0 est :", standard_errors, "\n")

```
Concernant les erreurs standard des coefficients (\( \beta \)), elles montrent la pr√©cision des estimations pour chaque variable. Par exemple, l'erreur standard pour l'intercept (\( \beta_0 \)) est de **739.0052**, indiquant une incertitude √©lev√©e, tandis que des coefficients comme \( clDD \) et \( clFD \) ont des erreurs standard plus faibles, respectivement **0.3465** et **2.6350**, ce qui indique une estimation plus pr√©cise. Ces r√©sultats soulignent l'importance de certaines variables dans le mod√®le tout en r√©v√©lant une incertitude pour d'autres, ce qui pourrait guider une optimisation ou une simplification du mod√®le pour am√©liorer sa robustesse et sa compr√©hension.

### .V√©rification des hypoth√®ses du mod√®le
```{r}
# Intervalles de confiance pour les coefficients
conf_intervals <- confint(stepwise.model, level = 0.95)
cat("Intervalle de confiance pour Œ≤ :", conf_intervals, "\n")
```

### .V√©rification des hypoth√®ses du mod√®le **\(H_1\) : Centrage et lien (\(E(\varepsilon_i | X_i) = 0\))**,**\(H_3\) : Homosc√©dasticit√© (\(\text{Var}(\varepsilon_i | X_i) = \sigma^2\))**, **\(H_4\) : Inversibilit√© (\(\text{rg}(X) = p\))**

```{r}

# Extraire les diagnostics du mod√®le
diagnostics <- augment(stepwise.model)

# Palette de couleurs "Paired"
colors <- brewer.pal(n = 3, name = "Paired")

# Graphique 1: R√©sidus vs valeurs ajust√©es
p1 <- ggplot(diagnostics, aes(.fitted, .resid)) +
  geom_point(color = colors[1], alpha = 0.6) +
  geom_hline(yintercept = 0, linetype = "dashed", color = colors[2]) +
  labs(title = "R√©sidus vs Valeurs Ajust√©es", x = "Valeurs Ajust√©es", y = "R√©sidus") +
  theme_minimal(base_size = 15)

# Graphique 2: QQ plot des r√©sidus
p2 <- ggplot(diagnostics, aes(sample = .std.resid)) +
  stat_qq(color = colors[1], alpha = 0.6) +
  stat_qq_line(color = colors[2]) +
  labs(title = "QQ Plot des R√©sidus", x = "Quantiles Th√©oriques", y = "Quantiles Observ√©s") +
  theme_minimal(base_size = 15)

# Graphique 3: Scale-Location
p3 <- ggplot(diagnostics, aes(.fitted, sqrt(abs(.std.resid)))) +
  geom_point(color = colors[1], alpha = 0.6) +
  geom_smooth(method = "loess", color = colors[2], se = FALSE) +
  labs(title = "Scale-Location", x = "Valeurs Ajust√©es", y = "‚àö|R√©sidus Standardis√©s|") +
  theme_minimal(base_size = 15)

# Graphique 4: R√©sidus vs Leverage
p4 <- ggplot(diagnostics, aes(.hat, .std.resid)) +
  geom_point(color = colors[1], alpha = 0.6) +
  geom_smooth(method = "loess", color = colors[2], se = FALSE) +
  geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "gray") +
  labs(title = "R√©sidus vs Leverage", x = "Leverage", y = "R√©sidus Standardis√©s") +
  theme_minimal(base_size = 15)

# Affichage des graphiques en grille
grid.arrange(p1, p2, p3, p4, ncol = 2)



```

Les graphiques de diagnostic permettent d'√©valuer les hypoth√®ses \(H_1\), \(H_2\), et \(H_3\) relatives √† la r√©gression lin√©aire multiple. Concernant \(H_1\) (Centrage et lien), le graphique des r√©sidus vs valeurs ajust√©es montre une l√©g√®re courbure, sugg√©rant une potentielle non-lin√©arit√©. Une solution serait d'ajouter des termes quadratiques ou d'interaction dans le mod√®le pour capturer ces effets non lin√©aires. Pour \(H_2\) (D√©corr√©lation), bien que le Q-Q plot montre une normalit√© globale, des √©carts aux extr√©mit√©s indiquent des valeurs influentes ; il est recommand√© d'utiliser une m√©thode robuste aux valeurs aberrantes, comme la r√©gression robuste, ou d'exclure ces points apr√®s v√©rification. Enfin, pour \(H_3\) (Homosc√©dasticit√©), le graphique Scale-Location r√©v√®le une variance non constante des r√©sidus (h√©t√©rosc√©dasticit√©). Une solution consiste √† utiliser des erreurs standards robustes (par exemple, la m√©thode de White) ou √† transformer la variable d√©pendante pour stabiliser la variance. Ces ajustements peuvent am√©liorer la validit√© et la robustesse du mod√®le.




### .Distribution des coefficients VIF
```{r}
# Calcul des VIF pour le mod√®le stepwise
vif_values <- vif(stepwise.model)

# Cr√©ation du dataframe des VIF
vif_df <- data.frame(Variable = names(vif_values), VIF = vif_values)

# Graphique des VIF
ggplot(vif_df, aes(x = reorder(Variable, -VIF), y = VIF, fill = VIF)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "Multicolin√©arit√© des variables (VIF)", x = "Variables", y = "Valeur VIF") +
  theme_minimal(base_size = 15) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Ce graphique montre les valeurs VIF (Variance Inflation Factor) des variables utilis√©es dans le mod√®le, permettant d'√©valuer la multicolin√©arit√©. Les variables grass et NDVI pr√©sentent des VIF faibles, sugg√©rant une faible corr√©lation avec d'autres variables du mod√®le. En revanche, clDD et clTma affichent des VIF mod√©r√©s, autour de 3, indiquant une corr√©lation potentielle entre ces variables. Cependant, comme ces valeurs restent inf√©rieures au seuil critique de 5 ou 10 (selon les standards), la multicolin√©arit√© ne semble pas probl√©matique dans ce mod√®le, mais elle m√©rite une attention particuli√®re.


### .Distribution des r√©sidus
```{r}

# Graphique des r√©sidus avec palette "Paired"
residuals_df <- data.frame(Residuals = residuals(stepwise.model))

# D√©finir les couleurs de la palette "Paired"
colors <- brewer.pal(n = 3, name = "Paired")  # Extraire 3 couleurs de la palette

ggplot(residuals_df, aes(x = Residuals)) +
  geom_histogram(binwidth = 5, fill = colors[1], color = colors[2], alpha = 0.7) +  # Couleurs de la palette
  labs(
    title = "Distribution des R√©sidus du Mod√®le", 
    x = "R√©sidus", 
    y = "Fr√©quence"
  ) +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12)
  )


```

Ce graphique illustre la distribution des r√©sidus du mod√®le. La forme globale en cloche sugg√®re que les r√©sidus suivent approximativement une distribution normale, bien que des √©carts soient visibles aux extr√©mit√©s. La majorit√© des r√©sidus sont centr√©s autour de z√©ro, ce qui indique que le mod√®le ne pr√©sente pas de biais syst√©matique. Cependant, la pr√©sence de quelques valeurs extr√™mes (outliers) pourrait influencer la pr√©cision et la robustesse du mod√®le. Une investigation suppl√©mentaire sur ces r√©sidus atypiques pourrait √™tre n√©cessaire pour garantir une meilleure qualit√© du mod√®le.


### .Analyse de partition de la variance
```{r}
# Partition de la variance entre climat et paysage
part.lm <- varpart(Dickcissel$abund,
                   Dickcissel[, c("clDD", "clTma")],
                   Dickcissel[, c("NDVI", "grass")])

# R√©sum√© des r√©sultats
print(part.lm)

# D√©finir les couleurs de la palette "Paired"
colors <- brewer.pal(n = 3, name = "Paired")  # Palette avec 3 couleurs

# Graphique de partition avec couleurs personnalis√©es
showvarparts(2)
plot(part.lm, digits = 2,
     bg = c(colors[1], colors[2], colors[3]),  # Couleurs des cercles
     col = "black",  # Couleur des bordures
     main = "Partition de la Variance (Palette Paired)")

```

Ce diagramme de Venn illustre la d√©composition de la variance expliqu√©e par deux groupes de variables, X1 et X2, sur la variable d√©pendante. Le groupe X1 explique 18,5 % de la variance totale, tandis que X2 en explique 1,5 %. L‚Äôintersection des deux cercles (1,0 %) repr√©sente la variance partag√©e entre X1 et X2, soulignant une corr√©lation ou un chevauchement dans leur contribution explicative. Cependant, une part importante de la variance (70 %) reste inexpliqu√©e, indiquant la n√©cessit√© d‚Äôexplorer d'autres variables ou approches pour am√©liorer la capacit√© explicative du mod√®le.


### .Tests d'ANOVA pour les mod√®les
```{r}
# Mod√®le avec variables climatiques
out.1 <- rda(Dickcissel$abund ~ clDD + clTma, data = Dickcissel)

# Mod√®le avec variables paysag√®res
out.2 <- rda(Dickcissel$abund ~ NDVI + grass, data = Dickcissel)

# Tests d'ANOVA pour les deux mod√®les
anova_climatique <- anova(out.1, step = 1000, perm.max = 1000)
anova_paysager <- anova(out.2, step = 1000, perm.max = 1000)

# R√©sum√© des tests
print(anova_climatique)
print(anova_paysager)
```
### .R√©sidus vs Variables
```{r}
# R√©sidus vs Variables

# Liste des variables pour les r√©sidus
variables <- c("clFD", "clTmi", "clTma", "clP", "NDVI", "grass")

# Palette de couleurs "Paired" pour unifier les graphiques
colors <- RColorBrewer::brewer.pal(n = 6, name = "Paired")

# Cr√©ation des graphiques
plots <- lapply(seq_along(variables), function(i) {
  ggplot(Dickcissel, aes_string(x = variables[i], y = "residuals(stepwise.model)")) +
    geom_point(color = colors[i], alpha = 0.6) +
    geom_smooth(method = "lm", color = "black", se = FALSE, linetype = "dotted") +
    labs(title = paste("R√©sidus vs", variables[i]), x = variables[i], y = "R√©sidus") +
    theme_minimal() +
    theme(
      plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
      axis.title = element_text(size = 12),
      axis.text = element_text(size = 10)
    )
})

# Affichage des graphiques en grille
do.call(grid.arrange, c(plots, ncol = 3))

```


Dans l'ensemble, les graphiques des r√©sidus montrent que certaines variables (comme clFD et clP) sont bien mod√©lis√©es, tandis que d'autres, comme clTmi et clTma, pr√©sentent des signes de non-lin√©arit√© ou d'interactions non prises en compte. Des am√©liorations pourraient √™tre apport√©es en testant des transformations (termes quadratiques ou logarithmiques) ou en explorant des interactions suppl√©mentaires entre les variables explicatives. Pour NDVI, les valeurs extr√™mes m√©riteraient une attention particuli√®re, comme la v√©rification de leur influence sur le mod√®le.


## .Pr√©diction
```{r}
# Donn√©es pour la pr√©diction (exemple de nouvelles valeurs pour les variables)
new_data <- data.frame(
  clDD = c(5500, 6000, 6500),
  clFD = c(80, 85, 90),
  clTmi = c(10, 12, 14),
  clTma = c(30, 32, 34),
  clTmn = c(15, 16, 17),
  clP = c(100, 110, 120),
  NDVI = c(-50, -45, -40),
  broadleaf = c(0.3, 0.4, 0.5),
  conif = c(0.2, 0.25, 0.3),
  grass = c(0.1, 0.15, 0.2),
  crop = c(0.5, 0.55, 0.6),
  urban = c(0.05, 0.06, 0.07),
  wetland = c(0.01, 0.02, 0.03)
)

# Pr√©diction des valeurs de abund avec intervalles de confiance
predictions <- predict(stepwise.model, newdata = new_data, interval = "confidence", level = 0.95)

# R√©sultats des pr√©dictions
pred_results <- cbind(new_data, predictions)
print(pred_results)

ggplot(data = data.frame(pred_results), aes(x = clDD, y = fit)) +
  geom_point(color = scales::brewer_pal(palette = "Paired")(2)[1], size = 3) +  # Couleur pour les points
  geom_errorbar(aes(ymin = lwr, ymax = upr), color = scales::brewer_pal(palette = "Paired")(2)[2], width = 50) +  # Couleur pour les barres
  labs(
    title = "Pr√©dictions avec intervalles de confiance",
    x = "clDD",
    y = "Pr√©dictions de abund"
  ) +
  theme_minimal()


```


Les valeurs pr√©dites (`fit`) fournissent les estimations du mod√®le pour la variable d√©pendante `abund`, en fonction des valeurs explicatives fournies (`clDD`). Les intervalles de confiance √† 95% sont repr√©sent√©s par `lwr` (limite inf√©rieure) et `upr` (limite sup√©rieure). Pour le premier point (clDD autour de 5700), la valeur pr√©dite est de **27.32**, avec un intervalle de confiance compris entre **12.27** et **42.37**, indiquant une bonne pr√©cision. Pour le second point (clDD autour de 6000), la valeur pr√©dite augmente √† **124.12**, mais l'intervalle de confiance est plus large (**31.56** √† **216.69**), refl√©tant une plus grande incertitude. Enfin, pour le troisi√®me point (clDD autour de 6300), la valeur pr√©dite atteint **319.76**, avec un intervalle de confiance encore plus √©tendu (**134.13** √† **505.39**), signalant une incertitude accrue. Le graphique montre une augmentation des valeurs pr√©dites avec `clDD`, mais l'√©largissement des intervalles de confiance pour les valeurs √©lev√©es de `clDD`



# .Conclusion G√©n√©rale  

Cette √©tude a permis d‚Äôexplorer et de mod√©liser l‚Äôabondance des dickcissels en fonction de variables climatiques et paysag√®res. √Ä travers une analyse rigoureuse, incluant des approches univari√©es, bivari√©es et multivari√©es, nous avons identifi√© les facteurs d√©terminants influen√ßant cette abondance. Les variables telles que `clTma`, `clFD`, et `grass` ont √©merg√© comme significatives dans le mod√®le final, expliquant une proportion notable de la variance totale (R¬≤ ajust√© = 0.56). Ces r√©sultats soulignent l‚Äôinteraction complexe entre les caract√©ristiques climatiques et paysag√®res dans la distribution des dickcissels.

L'approche utilis√©e, combinant s√©lection de variables et validation du mod√®le, a renforc√© la robustesse des r√©sultats obtenus. Bien que le mod√®le final fournisse des informations pertinentes, une variance inexpliqu√©e subsiste, sugg√©rant que d'autres facteurs, non inclus dans cette analyse, pourraient √©galement jouer un r√¥le. Ces r√©sultats offrent une base solide pour des recherches futures visant √† affiner la compr√©hension des facteurs influen√ßant la dynamique des populations de dickcissels.


